rm(list=ls())
setwd("C:/Users/rs/Desktop/Jaykumar")
pkgs <- c("data.table","dplyr","caTools","forecast","tidyr","tseries")
sapply(pkgs,require,character.only=TRUE)

#read the data
data <- read.csv("Sales.csv")
data$Date <- as.Date(strptime(data$Date,"%m/%d/%Y"))

# check the missing days
date_range <- seq(min(data$Date), max(data$Date), by = 1) 
date_range[!date_range %in% data$Date] 

# impute the values for NAs
data <-  data %>%
  mutate(Date = as.Date(Date)) %>%
  complete(Date = seq.Date(min(Date), max(Date), by="day")) %>%
  fill('Offered')

ts_data <- ts(data$Offered,frequency = 365,start=c(2012,1)) 
plot(ts_data)

# decompose the time series
decom <- decompose(ts_data)
plot(decom)

# Augmented Dickey-Fuller Test (ADF) - test if data is stationary
stationary_test <- adf.test(ts_data, alternative = "stationary")

acf(ts_data)
acf(diff(ts_data))
pacf(ts_data)

# arima model
fit <- auto.arima(ts_data, seasonal = TRUE)
tsdisplay(residuals(fit), main = "Model Residuals")

# forecast
fcast <- forecast(fit, h = 180)
plot(fcast)

